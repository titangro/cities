(window.webpackJsonpcities=window.webpackJsonpcities||[]).push([[0],{48:function(e,t,n){e.exports=n(72)},58:function(e,t,n){},59:function(e,t,n){},72:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(18),i=n.n(c),l=n(27),o=n(42),u=n(23),s=n(11),f={error:null,loading:!1,cities:[],city:null},d={ERROR:"cities/app/error",ERROR_DELETE:"cities/app/error/delete",LOADED:"cities/app/loaded",LOADING:"cities/app/loading"},m={GET:"cities/app/get",SHOW:"cities/app/show",SHOW_DETAILS:"cities/app/details"};var p=n(43);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var h,g,y=Object(s.c)({loading:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f.loading;switch((arguments.length>1?arguments[1]:void 0).type){case d.LOADING:return!0;case d.LOADED:return!1;default:return e}},error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f.error,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d.ERROR:return t.error;case d.ERROR_DELETE:return null;default:return e}},cities:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f.cities,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m.GET:return t.cities;default:return e}},city:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f.city,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m.SHOW:return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(n,!0).forEach(function(t){Object(p.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t.city,{salaries:t.salaries,scores:t.scores,details:t.details});default:return e}}});var v=o.__PRODUCTION__?function(e){return h||(h=Object(s.e)(y,e,Object(s.d)(Object(s.a)(u.a),"undefined"!==typeof window&&window.devToolsExtension?window.devToolsExtension():function(e){return e})))}:function(e){if(g)return g;var t=Object(s.e)(y,e,Object(s.d)(Object(s.a)(u.a),"undefined"!==typeof window&&window.devToolsExtension?window.devToolsExtension():function(e){return e}));return g=t},O=(n(57),n(58),n(59),n(15)),b=n(12),_=n(8),j=n(19),w=function(){return{type:d.LOADING}},R=function(){return{type:d.LOADED}},I=function(e){return function(t){return t({type:d.ERROR,error:e})}},D=function(e){return function(t){t(w()),fetch(e).then(function(e){return e.json()}).then(function(e){e.count?(t(function(e){return e({type:d.ERROR_DELETE})}),t(function(e){return function(t){t(R()),t({type:m.GET,cities:e})}}(e._embedded["city:search-results"]))):t(I("\u041f\u043e \u0434\u0430\u043d\u043d\u043e\u043c\u0443 \u0437\u0430\u043f\u0440\u043e\u0441\u0443 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u043d\u0438 1 \u0433\u043e\u0440\u043e\u0434"))},function(e){return t(I(e))})}},x=function(e){return function(t){t(w()),fetch(e).then(function(e){return e.json()}).then(function(e){return t((n=e,function(e){if(n._links["city:urban_area"]){var t=n._links["city:urban_area"].href;Promise.all([fetch("".concat(t,"salaries/")).then(function(e){return e.json()}).then(function(e){return e}),fetch("".concat(t,"scores/")).then(function(e){return e.json()}).then(function(e){return e}),fetch("".concat(t,"details/")).then(function(e){return e.json()}).then(function(e){return e})]).then(function(t){var a=Object(j.a)(t,3),r=a[0],c=a[1],i=a[2];e(R()),e({type:m.SHOW,city:n,salaries:r,scores:c,details:i})})}else e({type:m.SHOW,city:n})}));var n},function(e){return t(I(e))})}},A=n(74),S=n(82),T=n(80),C=n(75),L=n(81),P=Object(b.f)(function(e){var t=e.cities,n=e.fetchCities,c=e.apiRoot,i=e.history,l=e.error,o=null,u=Object(a.useState)(function(){return i.location.search?i.location.search.slice(1).split("=")[1]:""}),s=Object(j.a)(u,2),f=s[0],d=s[1];return Object(a.useEffect)(function(){var e="".concat(c,"cities/?search=").concat(f);n(e),i.push("/list?search=".concat(f))},[f]),r.a.createElement(A.a,null,r.a.createElement("h1",null,"\u041f\u043e\u0438\u0441\u043a \u0433\u043e\u0440\u043e\u0434\u043e\u0432"),r.a.createElement(S.a,{className:"mb-3"},r.a.createElement(T.a,{name:"cities",ref:function(e){return o=e},placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0433\u043e\u0440\u043e\u0434\u0430","aria-label":"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0433\u043e\u0440\u043e\u0434\u0430","aria-describedby":"basic-addon2",defaultValue:i.location.search?decodeURI(i.location.search.slice(1).split("=")[1]):""}),r.a.createElement(S.a.Append,null,r.a.createElement(C.a,{variant:"outline-secondary",onClick:function(){d(o.value)}},"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a"))),t.length&&!l?r.a.createElement(L.a,null,r.a.createElement("p",null,"\u041d\u0430\u0439\u0434\u0435\u043d\u043e: ",t.length," \u0433\u043e\u0440\u043e\u0434\u043e\u0432"),t.map(function(e,t){var n=e._links["city:item"].href.slice(1,-1).split("/").pop().split(":").pop();return r.a.createElement(L.a.Item,{action:!0,key:t},r.a.createElement(O.b,{to:"/search/".concat(n)},e.matching_full_name))})):l?r.a.createElement("p",null,l):r.a.createElement("p",null,"\u041f\u043e\u043a\u0430 \u0441\u043f\u0438\u0441\u043e\u043a \u0433\u043e\u0440\u043e\u0434\u043e\u0432 \u043f\u0443\u0441\u0442"))}),k=function(){return r.a.createElement(A.a,null,r.a.createElement("h1",null,"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c!"),r.a.createElement(O.b,{to:"/list"},"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u043f\u043e\u0438\u0441\u043a\u0443"))},B=n(77),G=n(78),H=n(13),N=n(79),W=n(76),K=function(e){var t,n=e.data,c=Object(a.useState)("percentile_25"),i=Object(j.a)(c,2),l=i[0],o=i[1];return Object(a.useEffect)(function(){H.a(t).selectAll("*").remove();H.a(t).append("svg").attr("width","100%").attr("height",400)},[n]),r.a.createElement(A.a,null,r.a.createElement(L.a,{as:"ul"},r.a.createElement(L.a.Item,{as:"li",active:!0},"\u041f\u0440\u043e\u0446\u0435\u043d\u0442 \u0437\u0430\u0440\u043f\u043b\u0430\u0442 \u043d\u0430\u0441\u0435\u043b\u0435\u043d\u0438\u044f"),r.a.createElement(L.a.Item,{as:"li"},r.a.createElement(N.a,{id:"salary_percentiles",activeKey:l,onSelect:function(e){return o(e)}},r.a.createElement(W.a,{eventKey:"percentile_25",title:"25%"},n.salaries[0].job.title,n.salaries[0].salary_percentiles[l]),r.a.createElement(W.a,{eventKey:"percentile_50",title:"50%"},n.salaries[0].job.title,n.salaries[0].salary_percentiles[l]),r.a.createElement(W.a,{eventKey:"percentile_75",title:"75%"},n.salaries[0].job.title,n.salaries[0].salary_percentiles[l])),r.a.createElement("div",{ref:function(e){return t=e}}))))},U=function(e){var t,n=e.data;return Object(a.useEffect)(function(){H.a(t).selectAll("*").remove();var e=H.a(t).append("svg").attr("width","100%").attr("height",400);e.selectAll("rect").data(n.categories).enter().append("rect").attr("width",45).attr("height",function(e){return 20*e.score_out_of_10}).attr("fill",function(e){return e.color}).attr("x",function(t,a){return e.node().getBoundingClientRect().width/n.categories.length*a}).attr("y",400).transition().duration(800).attr("y",function(e){return 400-20*e.score_out_of_10}),e.selectAll("text").data(n.categories).enter().append("text").attr("x",function(t,a){return e.node().getBoundingClientRect().width/n.categories.length*a-10}).attr("y",function(e){return 400-20*e.score_out_of_10-10}).attr("transform",function(t,a){return"rotate(-90, ".concat(e.node().getBoundingClientRect().width/n.categories.length*a+5,", ").concat(400-20*t.score_out_of_10-30,")")}).transition().duration(800).attr("x",function(t,a){return e.node().getBoundingClientRect().width/n.categories.length*a}).text(function(e){return e.name}),e.selectAll(".scores").data(n.categories).enter().append("text").attr("x",function(t,a){return e.node().getBoundingClientRect().width/n.categories.length*a-10}).attr("y",function(e){return 390}).attr("fill","#ffffff").transition().duration(800).attr("x",function(t,a){return e.node().getBoundingClientRect().width/n.categories.length*a+10}).text(function(e){return e.score_out_of_10.toFixed(1)})},[n]),r.a.createElement(A.a,null,r.a.createElement(L.a,{as:"ul"},r.a.createElement(L.a.Item,{as:"li",active:!0},"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u0438"),r.a.createElement(L.a.Item,{as:"li"},r.a.createElement("div",{ref:function(e){return t=e}})),r.a.createElement(L.a.Item,{as:"li",dangerouslySetInnerHTML:{__html:n.summary}})))},F=function(e){var t,n=e.data;return Object(a.useEffect)(function(){H.a(t).selectAll("*").remove();H.a(t).append("svg").attr("width","100%").attr("height",400)},[n]),r.a.createElement(A.a,null,r.a.createElement(L.a,{as:"ul"},r.a.createElement(L.a.Item,{as:"li",active:!0},"\u0414\u0435\u0442\u0430\u043b\u044c\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"),r.a.createElement(L.a.Item,{as:"li"},n.categories[0].label,r.a.createElement("div",{ref:function(e){return t=e}}))))},J=function(e){var t=e.city,n=e.cityId,c=e.fetchCity,i=e.apiRoot;return Object(a.useEffect)(function(){var e="".concat(i,"cities/geonameid:").concat(n);c(e)},[n]),t?r.a.createElement(A.a,null,r.a.createElement("h1",null,t.name),r.a.createElement(L.a,{as:"ul"},r.a.createElement(L.a.Item,{as:"li"},"\u041c\u0435\u0441\u0442\u043e\u043d\u0430\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0435: ",t.full_name),r.a.createElement(L.a.Item,{as:"li",active:!0},"\u041a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u044b: ",t.location.latlon.latitude," ",t.location.latlon.longitude),r.a.createElement(L.a.Item,{as:"li"},"Morbi leo risus"),r.a.createElement(L.a.Item,{as:"li",active:!0},"\u041d\u0430\u0441\u0435\u043b\u0435\u043d\u0438\u0435: ",t.population.toLocaleString("ru-RU")," \u0447\u0435\u043b\u043e\u0432\u0435\u043a"),r.a.createElement(L.a.Item,{as:"li"},t.salaries||t.scores||t.details?r.a.createElement(r.a.Fragment,null,r.a.createElement(A.a,null,"\u0415\u0441\u0442\u044c \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435"),r.a.createElement(B.a,null,r.a.createElement(G.a,null,r.a.createElement(K,{data:t.salaries}))),r.a.createElement(B.a,null,r.a.createElement(G.a,null,r.a.createElement(U,{data:t.scores}))),r.a.createElement(B.a,null,r.a.createElement(G.a,null,r.a.createElement(F,{data:t.details})))):"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e\u0442\u0441\u0443\u0442\u0441\u0432\u0443\u044e\u0442"))):""},M=function(e){console.log(e);var t=Object(_.a)({basename:"/cities"});return r.a.createElement(O.a,{basename:"/cities"},r.a.createElement("div",{className:"wrapper"},r.a.createElement(b.c,null,r.a.createElement(b.a,{exact:!0,path:"/",component:k}),r.a.createElement(b.a,{path:"/list"},r.a.createElement(P,Object.assign({},e,{history:t}))),r.a.createElement(b.a,{path:"/search/:cityId",children:function(t){var n=t.match;return r.a.createElement(J,Object.assign({},e,{cityId:n.params.cityId}))}}))))};M.defaultProps={apiRoot:"https://api.teleport.org/api/"};var V=Object(l.b)(function(e){return{error:e.error,loading:e.loading,cities:e.cities,city:e.city}},function(e){return{fetchCities:function(t){return e(D(t))},fetchCity:function(t){return e(x(t))}}})(M),q=v(f);i.a.render(r.a.createElement(l.a,{store:q},r.a.createElement(V,null)),document.getElementById("root"))}},[[48,1,2]]]);
//# sourceMappingURL=main.3ab2c919.chunk.js.map